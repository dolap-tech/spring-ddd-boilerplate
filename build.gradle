buildscript {
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath "org.springframework.boot:spring-boot-gradle-plugin:3.0.5"
	}
}

allprojects {
	apply plugin: "java"
	apply plugin: "org.springframework.boot"
	apply plugin: "io.spring.dependency-management"

	repositories {
		mavenLocal()
		mavenCentral()
	}

	ext {
		apacheCommonsVersion = "3.12.0"
		springbootStarterVersion = "3.0.5"
		springbootStarterTestVersion = "3.0.5"
		testContainerVersion = "1.17.6"
		jUnitVersion = "5.9.2"
		jUnitPlatformVersion = "1.9.2"
		mockitoVersion = "5.2.0"
		byteBuddyVersion = "1.14.3"
		jacksonVersion = "2.14.2"
	}

	dependencies {
		implementation "org.apache.commons:commons-lang3:${apacheCommonsVersion}"
		implementation 'org.springframework.boot:spring-boot-starter'
		implementation "com.fasterxml.jackson.core:jackson-annotations:${jacksonVersion}"

		// TEST
		testImplementation("org.springframework.boot:spring-boot-starter-test:${springbootStarterTestVersion}") {
			exclude group: 'junit', module: 'junit'
		}

		// TEST-CONTAINER
		testImplementation "org.testcontainers:testcontainers:${testContainerVersion}"
		testImplementation "org.testcontainers:postgresql:${testContainerVersion}"

		// JUNIT-5 AND MOCKITO-3
		testImplementation "org.junit.jupiter:junit-jupiter-api:${jUnitVersion}"
		testImplementation "org.junit.jupiter:junit-jupiter-params:${jUnitVersion}"
		testImplementation "org.junit.jupiter:junit-jupiter-engine:${jUnitVersion}"
		testImplementation "org.mockito:mockito-core:${mockitoVersion}"
		testImplementation "org.mockito:mockito-inline:${mockitoVersion}"
		testImplementation "net.bytebuddy:byte-buddy:${byteBuddyVersion}"

		testImplementation "org.junit.platform:junit-platform-launcher:${jUnitPlatformVersion}"
		testImplementation "org.junit.platform:junit-platform-engine:${jUnitPlatformVersion}"
		testImplementation "org.junit.platform:junit-platform-commons:${jUnitPlatformVersion}"
	}

	group "com.dolap.product"
	version "1.0.0"

	java {
		sourceCompatibility = JavaVersion.VERSION_17
		targetCompatibility = JavaVersion.VERSION_17
	}

	test {
		useJUnitPlatform()
		testLogging {
			events "passed", "skipped", "failed", "standardOut", "standardError"

			afterSuite { desc, result ->
				if (!desc.parent) {
					def output =  project.name + " module results: ${result.resultType} (${result.testCount} tests, ${result.successfulTestCount} passed, ${result.failedTestCount} failed, ${result.skippedTestCount} skipped)"
					println(output)
				}
			}
		}
	}
}
